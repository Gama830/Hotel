{% extends 'base.html' %}

{% block content %}
<style>
    .dashboard-content {
        padding: 20px;
        background-color: #f5f5f5;
        min-height: 100vh;
    }

    .dashboard-header {
        background: white;
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .dashboard-header h1 {
        font-size: 2.2rem;
        font-weight: 700;
        color: #333;
        margin-bottom: 8px;
    }

    .dashboard-header p {
        color: #666;
        font-size: 1rem;
    }

    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 25px;
    }

    .kpi-card {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .kpi-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    .kpi-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }

    .kpi-icon {
        width: 45px;
        height: 45px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
        font-size: 1.3rem;
        color: white;
    }

    .kpi-icon.rooms {
        background: linear-gradient(135deg, #667eea, #764ba2);
    }

    .kpi-icon.bookings {
        background: linear-gradient(135deg, #f093fb, #f5576c);
    }

    .kpi-icon.revenue {
        background: linear-gradient(135deg, #4facfe, #00f2fe);
    }

    .kpi-icon.guests {
        background: linear-gradient(135deg, #43e97b, #38f9d7);
    }

    .kpi-icon.occupancy {
        background: linear-gradient(135deg, #fa709a, #fee140);
    }

    .kpi-icon.checkins {
        background: linear-gradient(135deg, #a8edea, #fed6e3);
    }

    .kpi-title {
        font-size: 0.85rem;
        color: #666;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .kpi-value {
        font-size: 2rem;
        font-weight: 700;
        color: #333;
        margin: 8px 0;
    }

    .kpi-subtitle {
        font-size: 0.8rem;
        color: #888;
    }

    .growth-indicator {
        display: inline-flex;
        align-items: center;
        padding: 3px 6px;
        border-radius: 15px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-left: 8px;
    }

    .growth-positive {
        background: rgba(76, 175, 80, 0.1);
        color: #4caf50;
    }

    .growth-negative {
        background: rgba(244, 67, 54, 0.1);
        color: #f44336;
    }

    .content-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 25px;
        margin-bottom: 25px;
    }

    .chart-section,
    .info-section {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .section-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: #333;
        display: flex;
        align-items: center;
    }

    .section-title i {
        margin-right: 8px;
        color: #667eea;
    }

    .room-status-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 12px;
        margin-bottom: 15px;
    }

    .status-item {
        text-align: center;
        padding: 12px;
        border-radius: 8px;
        background: #f8f9fa;
    }

    .status-item.available {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        color: #155724;
    }

    .status-item.occupied {
        background: linear-gradient(135deg, #f8d7da, #f5c6cb);
        color: #721c24;
    }

    .status-item.maintenance {
        background: linear-gradient(135deg, #fff3cd, #ffeaa7);
        color: #856404;
    }

    .status-number {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 4px;
    }

    .status-label {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .booking-list {
        max-height: 280px;
        overflow-y: auto;
    }

    .booking-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
    }

    .booking-item:last-child {
        border-bottom: none;
    }

    .booking-guest {
        font-weight: 600;
        color: #333;
        font-size: 0.9rem;
    }

    .booking-room {
        font-size: 0.8rem;
        color: #666;
    }

    .booking-date {
        font-size: 0.75rem;
        color: #888;
        text-align: right;
    }

    .status-badge {
        padding: 3px 6px;
        border-radius: 10px;
        font-size: 0.65rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .status-confirmed {
        background: #d1ecf1;
        color: #0c5460;
    }

    .status-checked-in {
        background: #d4edda;
        color: #155724;
    }

    .status-pending {
        background: #fff3cd;
        color: #856404;
    }

    .quick-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        margin-top: 15px;
    }

    .stat-item {
        text-align: center;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .stat-value {
        font-size: 1.3rem;
        font-weight: 700;
        color: #333;
    }

    .stat-label {
        font-size: 0.75rem;
        color: #666;
        margin-top: 4px;
        font-weight: 600;
    }

    .occupancy-meter {
        position: relative;
        width: 100px;
        height: 100px;
        margin: 15px auto;
    }

    .meter-circle {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: conic-gradient(#667eea 0deg, #667eea calc(var(--percentage) * 3.6deg), #e9ecef calc(var(--percentage) * 3.6deg), #e9ecef 360deg);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .meter-inner {
        width: 70px;
        height: 70px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
    }

    .meter-percentage {
        font-size: 1.2rem;
        font-weight: 700;
        color: #333;
    }

    .meter-label {
        font-size: 0.6rem;
        color: #666;
        text-transform: uppercase;
        font-weight: 600;
    }

    @media (max-width: 768px) {
        .content-grid {
            grid-template-columns: 1fr;
        }

        .kpi-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .dashboard-header h1 {
            font-size: 1.8rem;
        }
    }
</style>

<div class="dashboard-content">
    <!-- Header -->
    <div class="dashboard-header">
        <h1>üè† Dashboard Overview</h1>
        <p>Welcome back! Here's what's happening at your hotel today - {{ today|date:"F d, Y" }}</p>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid">
        <!-- Occupancy Rate -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon occupancy">
                    üìä
                </div>
                <div>
                    <div class="kpi-title">Occupancy Rate</div>
                </div>
            </div>
            <div class="occupancy-meter" style="--percentage: {{ occupancy_rate }}">
                <div class="meter-circle">
                    <div class="meter-inner">
                        <div class="meter-percentage">{{ occupancy_rate }}%</div>
                        <div class="meter-label">Occupied</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Total Rooms -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon rooms">
                    üè®
                </div>
                <div>
                    <div class="kpi-title">Room Status</div>
                </div>
            </div>
            <div class="kpi-value">{{ total_rooms }}</div>
            <div class="kpi-subtitle">Total Rooms</div>
            <div class="room-status-grid">
                <div class="status-item available">
                    <div class="status-number">{{ available_rooms }}</div>
                    <div class="status-label">Available</div>
                </div>
                <div class="status-item occupied">
                    <div class="status-number">{{ occupied_rooms }}</div>
                    <div class="status-label">Occupied</div>
                </div>
                <div class="status-item maintenance">
                    <div class="status-number">{{ maintenance_rooms }}</div>
                    <div class="status-label">Maintenance</div>
                </div>
            </div>
        </div>

        <!-- Revenue -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon revenue">
                    üí∞
                </div>
                <div>
                    <div class="kpi-title">Revenue ({{ current_month }})</div>
                </div>
            </div>
            <div class="kpi-value">${{ this_month_revenue|floatformat:0 }}</div>
            <div class="kpi-subtitle">
                vs Last Month: ${{ last_month_revenue|floatformat:0 }}
                {% if revenue_growth > 0 %}
                <span class="growth-indicator growth-positive">
                    ‚Üó {{ revenue_growth }}%
                </span>
                {% elif revenue_growth < 0 %} <span class="growth-indicator growth-negative">
                    ‚Üò {{ revenue_growth }}%
                    </span>
                    {% endif %}
            </div>
        </div>

        <!-- Bookings -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon bookings">
                    üìã
                </div>
                <div>
                    <div class="kpi-title">Bookings</div>
                </div>
            </div>
            <div class="kpi-value">{{ active_bookings }}</div>
            <div class="kpi-subtitle">Active Bookings</div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ pending_bookings }}</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ total_bookings }}</div>
                    <div class="stat-label">Total</div>
                </div>
            </div>
        </div>

        <!-- Today's Activity -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon checkins">
                    üïê
                </div>
                <div>
                    <div class="kpi-title">Today's Activity</div>
                </div>
            </div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ todays_checkins }}</div>
                    <div class="stat-label">Check-ins</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ todays_checkouts }}</div>
                    <div class="stat-label">Check-outs</div>
                </div>
            </div>
        </div>

        <!-- Guests -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon guests">
                    üë•
                </div>
                <div>
                    <div class="kpi-title">Guests</div>
                </div>
            </div>
            <div class="kpi-value">{{ total_guests }}</div>
            <div class="kpi-subtitle">Total Registered</div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ new_guests_this_month }}</div>
                    <div class="stat-label">New This Month</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${{ adr|floatformat:0 }}</div>
                    <div class="stat-label">Avg Daily Rate</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">
        <!-- Recent Bookings -->
        <div class="chart-section">
            <h3 class="section-title">üìã Recent Bookings</h3>
            <div class="booking-list">
                {% for booking in recent_bookings %}
                <div class="booking-item">
                    <div>
                        <div class="booking-guest">{{ booking.guest.full_name }}</div>
                        <div class="booking-room">Room {{ booking.room.room_number }} ‚Ä¢ {{ booking.duration_nights }}
                            nights</div>
                    </div>
                    <div>
                        <div class="booking-date">{{ booking.check_in_date|date:"M d" }} - {{
                            booking.check_out_date|date:"M d" }}</div>
                        <span class="status-badge status-{{ booking.status|lower|cut:' '|cut:'_' }}">{{
                            booking.get_status_display }}</span>
                    </div>
                </div>
                {% empty %}
                <p style="text-align: center; color: #666; padding: 20px;">No recent bookings</p>
                {% endfor %}
            </div>
        </div>

        <!-- Upcoming Check-ins -->
        <div class="info-section">
            <h3 class="section-title">üìÖ Upcoming Check-ins</h3>
            <div class="booking-list">
                {% for booking in upcoming_checkins %}
                <div class="booking-item">
                    <div>
                        <div class="booking-guest">{{ booking.guest.full_name }}</div>
                        <div class="booking-room">Room {{ booking.room.room_number }}</div>
                    </div>
                    <div class="booking-date">{{ booking.check_in_date|date:"M d, Y" }}</div>
                </div>
                {% empty %}
                <p style="text-align: center; color: #666; padding: 20px;">No upcoming check-ins</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}